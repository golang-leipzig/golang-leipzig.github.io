<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Virtual Meetup #19 wrap-up | Leipzig Gophers</title>

    <style>body{margin:1em auto;padding:1em;color:#2f2d2e;max-width:45em;line-height:1.6;font-family:Georgia,serif;font-size:1.2em}h1{border-bottom:2pt solid #2f2d2e}.header-menu{float:right}ul.pagination{list-style-type:none;text-align:center;padding:0}ul.pagination>li{padding:0 .4em;display:inline-block}div.footer{border-top:1pt solid;text-align:center;padding:1em}img{max-width:100%;max-height:100%;display:block;margin-left:auto;margin-right:auto}@media(min-width:45em){div.tags{float:right}}img[src*="#half"]{width:50%}a{text-decoration:none;color:#35a7ff;border-bottom:2pt solid #fff}a:visited{color:#ff5964}a:hover{border-bottom:2pt solid #ff5964;transition:all 333ms ease-in}a.tag{padding:.1em .4em;background:#2f2d2e;color:#fff;text-decoration:none;border-radius:5pt}a.anchor{padding-right:.3em;color:#d3d3d3}blockquote{color:#838383}</style>

    

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<meta name='impact-site-verification' value='54840aba-1503-416b-b5d7-dafee41af763'> 



</head>


<body>
<div class="header">
    <a href="/">Leipzig Gophers</a>
    <div class="header-menu">
        <a href="/posts/">blog</a>
    </div>
</div>
<div id="content">

<header>
    <h1 id="#virtual-meetup-19-wrap-up">
        <a class="anchor" href="#virtual-meetup-19-wrap-up">ðŸ”—</a>Virtual Meetup #19 wrap-up</h1>
    

<div class="post-meta"><time datetime="2021-06-23">Jun 23, 2021</time><div class="tags">
        Tags
        <a class="tag" href="https://golangleipzig.space/tags/summary/">summary</a>
        <a class="tag" href="https://golangleipzig.space/tags/meetup/">meetup</a>
    </div>
</div>
</header>
<article>
    <h2 id="journey-to-the-center-of-kubernetes">Journey to the Center of Kubernetes</h2>
<p>Meetup #19 took place <a href="https://www.meetup.com/Leipzig-Golang/events/275871279/">Jun 22, 2021 19:00
CEST</a>, and was virtual
again. <a href="https://www.mgasch.com">Michael Gasch</a> gave an input presentation on <a href="https://etcd.io/">etcd</a> and did a deep dive into its
role in the container-orchestrator <a href="https://kubernetes.io/">kubernetes</a>.</p>
<p>The talk is based on a blog post: <a href="https://www.mgasch.com/2021/01/listwatch-part-1/">Onwards to the Core: etcd</a>. A shell transcript can be found here:</p>
<ul>
<li><a href="https://gist.github.com/embano1/aedd423abe07c8012897658db15e139a">https://git.io/JnQ1n</a></li>
</ul>
<p>We learned about the API of etcd, its data model, key value stores layouts,
append-only storage and compaction. A recording of the talk is <a href="https://www.youtube.com/watch?v=Z9fwIzy0C_8">available on
YouTube</a>:</p>
<p><a href="https://www.youtube.com/watch?v=Z9fwIzy0C_8"><img src="http://img.youtube.com/vi/Z9fwIzy0C_8/0.jpg" alt="Leipzig Gophers #19: A Journey in the Kubernetes ListerWatcher Rabbit Hole"></a></p>
<p>A few highlights from the talk:</p>
<ul>
<li>etcd is a distributed key value store, using the <a href="https://raft.github.io/">RAFT</a> consensus algorithm.</li>
</ul>
<blockquote>
<p>Consensus algorithms allow a collection of machinesto work as a coherent
group that can survive the fail-ures of some of its members. Because of this,
they play akey role in building reliable large-scale software systems. &ndash; <a href="https://raft.github.io/raft.pdf">In Search of an Understandable Consensus Algorithm</a></p>
</blockquote>
<ul>
<li>etcd internally uses <a href="https://github.com/etcd-io/bbolt">boltdb</a>, especially
their own fork, as the original project has been
<a href="https://github.com/boltdb/bolt">archived</a> &ndash; boltdb itself is a Go
implementation of the
<a href="https://en.wikipedia.org/wiki/Lightning_Memory-Mapped_Database">LMDB</a> design,
which among many other things supports
<a href="https://en.wikipedia.org/wiki/Multiversion_concurrency_control">MVCC</a></li>
<li>etcd had hierarchical, but moved to a flat key value design; albeit you can
mimick hierarchy by using, e.g. path like notation; you can use the
<code>--prefix</code> flag to mimick recursive lists</li>
<li>kubernetes <code>ResourceVersion</code> relates directly to the revision in etcd; which is a monotonically increasing counter</li>
<li>kubernetes does not need to use etcd (others use <a href="https://www.sqlite.org/index.html">sqlite3</a> or <a href="https://docs.microsoft.com/en-us/azure/cosmos-db/introduction">Cosmos DB</a>), but etcd is the most common choice</li>
<li>etcd comes with an HTTP and a gRPC API</li>
<li>compaction in etcd is key to limit overall database size</li>
</ul>
<p>Kubernetes uses etcd as a registry with components starting to watch specific keys for events.</p>
<ul>
<li>the difference between edge-driven (a sequence of events that leads to a
state) and level-driven (transmit the whole state at once) design and its
reflection in the API (e.g. add, update, delete vs reconcile).</li>
</ul>
<p>Some tools mentioned or used in the talk:</p>
<ul>
<li><a href="https://stedolan.github.io/jq/">jq</a>, and its <a href="https://stedolan.github.io/jq/manual/#Formatstringsandescaping">base64</a> capabilities</li>
<li><a href="https://github.com/dandavison/delta">delta</a> for diffs</li>
<li><a href="https://github.com/jpbetz/auger">auger</a> - encodes and decodes Kubernetes objects from the binary storage encoding used to store data to etcd</li>
<li><a href="https://www.jaegertracing.io/">jaeger</a> or <a href="https://zipkin.io/">zipkin</a> for tracing</li>
<li><a href="https://github.com/uber-go/zap">zap</a> for structured logging</li>
</ul>
<h2 id="misc">Misc</h2>
<ul>
<li>Does your favorite encoding schema support tree structures natively? Would you be interested in an encoding that supports one? Please share your ideas at <a href="https://github.com/kstenerud/concise-encoding/issues/33">concise-encoding/issues/33</a></li>
<li><a href="https://cuelang.org/">Cuelang</a> - a language for configuration, database schemas, validation and more - e.g. to adress subtle issues like <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/MAX_SAFE_INTEGER">different int max sizes</a> across languages</li>
<li>Two cloud native books: <a href="https://www.oreilly.com/library/view/design-patterns-for/9781492090700/">Design Patterns for Cloud Native Applications</a> and <a href="https://www.oreilly.com/library/view/cloud-native-patterns/9781617294297/">Cloud Native Patterns</a></li>
<li><a href="https://scholar.google.com/citations?user=TKSjVTUAAAAJ&amp;hl=en">Peter Alvaro</a> at <a href="https://www.youtube.com/watch?v=R2Aa4PivG0g">Strange Loop</a> (2015, Distributed Systems, Data Management Systems)</li>
</ul>
<hr>
<p><a href="https://www.meetup.com/Leipzig-Golang">Join our meetup</a> to get notified of upcoming events!</p>

</article>


    </div>
<div class="footer">
    
    
    <div class="footer-links">
        <a href="https://www.meetup.com/Leipzig-Golang/">Meetup</a><span> / <span><a href="https://github.com/golang-leipzig">GitHub</a><span> / <span><a href="https://raw.githubusercontent.com/golang-leipzig/golang-leipzig.github.io/source/Impressum.txt">Imprint</a><span> / <span><a href="/qr.png">QR</a><span> / <span><a href="https://1mb.club/">1MB</a><span> / <span><a href="/llms.txt">LLM</a></div>
    

    
    
</div>
</body>

</html>